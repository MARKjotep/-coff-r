// @bun
import{F as c,N as o}from"./index-j8d2wq60.js";var{file:p}=globalThis.Bun;import{exists as m,mkdir as g,writeFile as u}from"fs/promises";var a=async(t)=>{return await m(t)},e=async(t,s="")=>{if(await a(t))return!0;return await u(t,s,{flag:"wx"}),!0},n=async(t)=>{if(await a(t))return!0;return await g(t,{recursive:!0}),!0};class d{path;envPath;constructor(t,s){this.path=t;this.envPath=s}async init(){if(!this.envPath)await n(this.path),await e(this.path+"/.env",`SECRET_KEY="${c(20)}"
TLS_KEY=""
TLS_CERT=""`);return this}secret(){let t=process.env.SECRET_KEY;if(!t)throw Error("'SECRET_KEY' not found in .env file");return t}tls(){return o(process.env).filter(([t])=>t.startsWith("TLS_")).reduce((t,[s,i])=>{if(i){let r=s.replace("TLS_","").toLowerCase();t[r]=p(i)}return t},{})}}var{file:f,write:h}=globalThis.Bun;class l{fs;f_timed;data;key;dir;constructor({dir:t,fs:s,key:i}){this.dir=t+"/ffs",this.key=i,this.f_timed=Date.now(),this.data=new Map,this.fs=this.dir+`/${s}.json`}async init(){if(await n(this.dir)&&await e(this.fs,"{}"))f(this.fs).text().then((t)=>{let s=JSON.parse(t);this.data=new Map(o(s))}).catch((t)=>{})}async get(t){let s=this.data.get(t);if(s)return s;return null}async queue(){}async set(t){if(this.key in t){let s=await f(this.fs).text();if(s){let i=JSON.parse(s),r=t[this.key];i[r]=t,await h(this.fs,JSON.stringify(i))}this.data.set(t[this.key],t)}return!1}async delete(t){if(await this.get(t)){let s=await f(this.fs).text();if(s){let i=JSON.parse(s.toString());if(t in i)delete i[t],await h(this.fs,JSON.stringify(i));this.data.delete(t)}}}async json(){let t=await f(this.fs).text();return JSON.parse(t)}}var C=(t,...s)=>{let i=new Bun.CryptoHasher("sha256",t);return s.forEach((r)=>{i.update(r)}),i.digest()};export{a as isPath,e as isFile,n as isDir,l as JSONCacher,d as Envy,C as Digest};
